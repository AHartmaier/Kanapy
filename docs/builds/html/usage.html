

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; kanapy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modeling approach" href="method.html" />
    <link rel="prev" title="Applications" href="applications.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> kanapy
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-examples">Running examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#detailed-tutorial">Detailed tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input-file-structure">Input file structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-workflows">Example workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sphere-packing">Sphere packing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ellipsoid-packing">Ellipsoid packing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="method.html">Modeling approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="kanapy.html">Code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">kanapy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="running-examples">
<h2>Running examples<a class="headerlink" href="#running-examples" title="Permalink to this headline">¶</a></h2>
<p>Two examples come bundled along with the kanapy package. You can run
them individually by navigating into the corresponding directories and executing
them as shown:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure that you are within the virtual environment created during kanapy installation.
As this environment contains the installed kanapy and its required dependencies.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate myenv
<span class="gp">(myenv) $</span> <span class="nb">cd</span> kanapy-master/examples/
<span class="gp">(myenv) $</span> <span class="nb">cd</span> sphere_packing/
<span class="gp">(myenv) $</span> python sphere_pack.py
</pre></div>
</div>
<p>You can view the data generated by the simulation (after the simulation
is complete or during the simulation) by launching OVITO and reading in
the dump files generated by kanapy from the <code class="docutils literal notranslate"><span class="pre">../sphere_packing/dump_files/</span></code> directory.
The UI should look similar to this:</p>
<a class="reference internal image-reference" href="_images/UI.png"><img alt="_images/UI.png" src="_images/UI.png" style="width: 750px;" /></a>
<p>By default OVITO loads the particles as spheres, to change this option to ellipsoids.
The asphericalshapex, asphericalshapey, and asphericalshapez columns need to be mapped to
Aspherical Shape.X, Aspherical Shape.Y, and Aspherical Shape.Z properties of OVITO when
importing the dump file. Similarily, the orientationx, orientationy, orientationz, and
orientationw particle properties need to be mapped to the Orientation.X, Orientation.Y,
Orientation.Z, and Orientation.W. OVITO cannot set up this mapping automatically, you have
to do it manually by using the <code class="docutils literal notranslate"><span class="pre">Edit</span> <span class="pre">column</span> <span class="pre">mapping</span></code> button (at the bottom right corner
of the GUI) in the file import panel after loading the dump files. The required assignment
and components are shown here:</p>
<a class="reference internal image-reference" href="_images/UI_options.png"><img alt="_images/UI_options.png" src="_images/UI_options.png" style="width: 750px;" /></a>
<p>For further viewing customization refer to OVITO’s <a class="reference external" href="https://ovito.org/manual/">documentation</a>.</p>
</div>
<div class="section" id="detailed-tutorial">
<h2>Detailed tutorial<a class="headerlink" href="#detailed-tutorial" title="Permalink to this headline">¶</a></h2>
<p>A detailed description of the default examples that come packaged with kanapy is presented here.
The two examples <code class="docutils literal notranslate"><span class="pre">sphere_packing</span></code> and <code class="docutils literal notranslate"><span class="pre">ellipsoid_packing</span></code> depict the different workflows
that has to be setup for generating synthetic microstructures with equiaxed and elongated
grains respectively. Both the examples contain an input file wherein the user can specify
the statistical parameters required for the simulation. For a detailed understanding of the
general framework of packing simulations please refer to: <a class="reference internal" href="method.html#modeling-approach"><span class="std std-ref">Modeling approach</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>New examples must be created in a separate directory under the <code class="docutils literal notranslate"><span class="pre">kanapy-master/examples/</span></code>
directory structure. It allows the kanapy modules an easy access to the json and
dump files created during the simulation.</p></li>
<li><p>The json and dump files help in making the various kanapy modules independent
of one another during execution.</p></li>
<li><p>The input file must always be named as: <code class="docutils literal notranslate"><span class="pre">stat_input.txt</span></code> to be read by kanapy.</p></li>
</ol>
</div>
<div class="section" id="input-file-structure">
<h3>Input file structure<a class="headerlink" href="#input-file-structure" title="Permalink to this headline">¶</a></h3>
<p>An exemplary structure of the input file: <code class="docutils literal notranslate"><span class="pre">stat_input.txt</span></code> is shown below:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>@ Equivalent diameter
<span class="nv">std</span> <span class="o">=</span>
<span class="nv">mean</span> <span class="o">=</span>
<span class="nv">cutoff_min</span> <span class="o">=</span>
<span class="nv">cutoff_max</span> <span class="o">=</span>

@ Aspect ratio
<span class="nv">mean</span> <span class="o">=</span>

@ Orientation
<span class="nv">sigma</span> <span class="o">=</span>
<span class="nv">mean</span> <span class="o">=</span>

@ RVE
<span class="nv">side_length</span> <span class="o">=</span>
<span class="nv">voxel_per_side</span> <span class="o">=</span>

@ Simulation
<span class="nv">nsteps</span> <span class="o">=</span>
<span class="nv">periodicity</span> <span class="o">=</span>
</pre></div>
</div>
<p>It is built with the following keywords: <code class="docutils literal notranslate"><span class="pre">&#64;</span> <span class="pre">Equivalent</span> <span class="pre">diameter,</span> <span class="pre">&#64;</span> <span class="pre">Aspect</span> <span class="pre">ratio,</span>
<span class="pre">&#64;</span> <span class="pre">Orientation,</span> <span class="pre">&#64;</span> <span class="pre">RVE,</span> <span class="pre">&#64;</span> <span class="pre">Simulation</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li><p>The keyword <code class="docutils literal notranslate"><span class="pre">&#64;</span> <span class="pre">Equivalent</span> <span class="pre">diameter</span></code> takes in four arguments to generate a
log-normal distribution for particle’s equivalent diameter, they are the
<a class="reference external" href="https://en.wikipedia.org/wiki/Log-normal_distribution">Log-normal distribution’s</a> standard deviation and mean, and the minimum
and maximum cut-off values for the diameter.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">&#64;</span> <span class="pre">Aspect</span> <span class="pre">ratio</span></code> takes only the mean value as input. If the resultant
microstructure should contain equiaxed grains then this value should be set to <cite>1</cite>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">&#64;</span> <span class="pre">Orientation</span></code> keyword represents the tilt angle of particles with
respect to the positive x-axis. Hence, to generate a distribution it takes in
two arguments: the normal distribution’s mean and the standard deviation.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">&#64;</span> <span class="pre">RVE</span></code> keyword takes two inputs: the side length of the final RVE
required and the number of voxels per RVE side length.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">&#64;</span> <span class="pre">Simulation</span></code> keyword takes in two inputs: The total number of time steps
and a boolean value for periodicity (True/False).</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The user may choose not to use the built-in voxelization (meshing) routine
for meshing the final RVE. Nevertheless, a value for <cite>voxel_per_side</cite> has to be provided.</p></li>
<li><p>A good estimation for <cite>voxel_per_side</cite> value can be made by keeping the
following point in mind: The smallest dimension of the smallest ellipsoid/sphere
should contain atleast 2 voxels.</p></li>
<li><p>The <cite>nsteps</cite> value determines the growth of the particle during the simulation.
At the start of the simulation all particles are initialized with null volume.
At each time step they grow in size by the value: diameter/nsteps. Theerefore, the last
timestep would naturally contain particles in their actual size.</p></li>
</ol>
</div>
</div>
<div class="section" id="example-workflows">
<h3>Example workflows<a class="headerlink" href="#example-workflows" title="Permalink to this headline">¶</a></h3>
<div class="section" id="sphere-packing">
<h4>Sphere packing<a class="headerlink" href="#sphere-packing" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates the workflow for generating synthetic microstructures with
equiaxed grains. The principle involved in generating such microstructures are described
in the sub-section <a class="reference internal" href="applications.html#microstructure-with-equiaxed-grains"><span class="std std-ref">Microstructure with equiaxed grains</span></a>. With respect to the final RVE mesh,
the user has the flexibility to choose between the in-built voxelization routine and external meshing softwares.</p>
<p>If external meshing is required then the positions and weights of the particles (spheres) after packing
can be written out to be post-processed. The positions and weights can be read by Voronoi tessellation
and meshing software <a class="reference external" href="http://neper.sourceforge.net/">Neper</a> for generating tessellations and FEM mesh. For more details refer to Neper’s
<a class="reference external" href="https://ovito.org/manual/">documentation</a>.</p>
<p>If the in-built voxelization routine is prefered, then the <a class="reference internal" href="kanapy.html#module-src.kanapy.voxelization"><span class="std std-ref">Module voxelization</span></a> will generate
hexahedral element (C3D8) mesh that can be read by commercial FEM software <a class="reference external" href="https://www.3ds.com/products-services/simulia/products/abaqus/">Abaqus</a>.</p>
<p><strong>Imports</strong>: This example requires the following imports from the python standard and kanapy modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../..&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">kanapy</span>
<span class="kn">from</span> <span class="nn">src.kanapy.input_output</span> <span class="kn">import</span> <span class="n">particleStatGenerator</span>
<span class="kn">from</span> <span class="nn">src.kanapy.input_output</span> <span class="kn">import</span> <span class="n">write_position_weights</span>
<span class="kn">from</span> <span class="nn">src.kanapy.packing</span> <span class="kn">import</span> <span class="n">packingRoutine</span>
</pre></div>
</div>
<p>The methods for generating particle distribution statistics and outputing particle
position and weights are imported from the <code class="docutils literal notranslate"><span class="pre">input_output</span></code> module. The routine
for the actual particle packing simulation is imported from the <code class="docutils literal notranslate"><span class="pre">packing</span></code> module.</p>
<p><strong>Workflow</strong>: The complete process consists of 3 stages:</p>
<blockquote>
<div><ul class="simple">
<li><p>Particle data generation.</p></li>
<li><p>Particle packing simulation.</p></li>
<li><p>Writing output files.</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">inputFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/stat_input.txt&#39;</span>
    <span class="n">particleStatGenerator</span><span class="p">(</span><span class="n">inputFile</span><span class="p">)</span>
    <span class="n">packingRoutine</span><span class="p">()</span>
    <span class="n">write_position_weights</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Individual stages can be run by commenting out the other stages but should be done sequentially.</p></li>
<li><p>The <a class="reference internal" href="kanapy.html#src.kanapy.input_output.particleStatGenerator" title="src.kanapy.input_output.particleStatGenerator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.particleStatGenerator()</span></code></a> method requires the <code class="docutils literal notranslate"><span class="pre">stat_input.txt</span></code> as input.</p></li>
<li><p>The <a class="reference internal" href="kanapy.html#src.kanapy.input_output.write_position_weights" title="src.kanapy.input_output.write_position_weights"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.write_position_weights()</span></code></a> method requires the simulation timestep as input.
The choice of the timestep is very important. It is suggested to choose the time step at which the spheres
are tightly packed and there is least amount of overlap. The remaining empty spaces will get assigned to
the closest sphere when it is sent to the tessellation and meshing routine. Please refer to
<a class="reference internal" href="applications.html#microstructure-with-equiaxed-grains"><span class="std std-ref">Microstructure with equiaxed grains</span></a> for more details.</p></li>
</ol>
</div>
<p>The data required for packing simulation contained in the user defined input file: <code class="docutils literal notranslate"><span class="pre">stat_input.txt</span></code> is read
by the method <a class="reference internal" href="kanapy.html#src.kanapy.input_output.particleStatGenerator" title="src.kanapy.input_output.particleStatGenerator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.particleStatGenerator()</span></code></a>. It generates the necessary particle, RVE and
the simulation attributes and writes it to json files. The method <a class="reference internal" href="kanapy.html#src.kanapy.packing.packingRoutine" title="src.kanapy.packing.packingRoutine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.packing.packingRoutine()</span></code></a> when
called looks for the json files generated by <a class="reference internal" href="kanapy.html#src.kanapy.input_output.particleStatGenerator" title="src.kanapy.input_output.particleStatGenerator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.particleStatGenerator()</span></code></a>
and reads the files for extracting information required for the packing simulation. At each time step of the
packing simulation the <a class="reference internal" href="kanapy.html#src.kanapy.packing.particle_grow" title="src.kanapy.packing.particle_grow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.packing.particle_grow()</span></code></a> method will write out a dump file containing information
of particle positions and other attributes.</p>
<p>Finally, the <a class="reference internal" href="kanapy.html#src.kanapy.input_output.write_position_weights" title="src.kanapy.input_output.write_position_weights"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.write_position_weights()</span></code></a> method can be called
to write out the position and weights files required for further post-processing. This function takes the
specified timestep value as an input parameter and reads the corresponding dump file generated previously.
By extracting the particle’s position and dimensions it creates the <code class="docutils literal notranslate"><span class="pre">sphere_positions.txt</span></code> &amp;
<code class="docutils literal notranslate"><span class="pre">sphere_weights.txt</span></code> files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For comparing the input and output statistics:</p>
<ol class="arabic simple">
<li><p>The json file <code class="docutils literal notranslate"><span class="pre">particle_data.txt</span></code> in the directory <code class="docutils literal notranslate"><span class="pre">../json_files/</span></code> can be used to
read the particle’s equivalent diameter as input statistics.</p></li>
<li><p>After tessellation,`Neper` can be used to generate the equivalent diameter for output statistics.</p></li>
</ol>
</div>
<p>If the built-in voxelization is prefered then the <a class="reference internal" href="kanapy.html#src.kanapy.voxelization.voxelizationRoutine" title="src.kanapy.voxelization.voxelizationRoutine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.voxelization.voxelizationRoutine()</span></code></a> method can be called
to generate the hexahedral mesh. This function also takes in the timestep value as an input parameter and reads the
corresponding dump file generated previously. The <a class="reference internal" href="kanapy.html#src.kanapy.input_output.write_abaqus_inp" title="src.kanapy.input_output.write_abaqus_inp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.write_abaqus_inp()</span></code></a> method can be called to
write out Abaqus (.inp) input file. The workflow for this looks like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.kanapy.voxelization</span> <span class="kn">import</span> <span class="n">voxelizationRoutine</span>
<span class="kn">from</span> <span class="nn">src.kanapy.input_output</span> <span class="kn">import</span> <span class="n">write_abaqus_inp</span><span class="p">,</span> <span class="n">write_output_stat</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">inputFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/stat_input.txt&#39;</span>
    <span class="n">particleStatGenerator</span><span class="p">(</span><span class="n">inputFile</span><span class="p">)</span>
    <span class="n">packingRoutine</span><span class="p">()</span>
    <span class="n">voxelizationRoutine</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
    <span class="n">write_abaqus_inp</span><span class="p">()</span>
    <span class="n">write_output_stat</span><span class="p">()</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For comparing the input and output equivalent diameter statistics the method
<a class="reference internal" href="kanapy.html#src.kanapy.input_output.write_output_stat" title="src.kanapy.input_output.write_output_stat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.write_output_stat()</span></code></a> can be called.</p>
</div>
<p>Storing information in json &amp; dump files is effective in making the workflow stages independent of one another.
But the sequence of the workflow is important, for example: Running the packing routine before the statistics generation
is not advised as the packing routine would not have any input to work on. Both the json and dump files are human readable
and hence they help the user debug the code in case of simulation problems. As mentioned earlier, the dump files can
be read by visualization software <a class="reference external" href="https://ovito.org/">OVITO</a>, this provides the user a visual aid to understand the physics behind packing.</p>
</div>
<div class="section" id="ellipsoid-packing">
<h4>Ellipsoid packing<a class="headerlink" href="#ellipsoid-packing" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates the workflow for generating synthetic microstructures with
elongated grains. The principle involved in generating such microstructures are described
in the sub-section <a class="reference internal" href="applications.html#microstructure-with-elongated-grains"><span class="std std-ref">Microstructure with elongated grains</span></a>. With respect to the final RVE mesh,
the built-in voxelization routine has to be used due to the inavailability of anisotropic tessellation techniques.
The <a class="reference internal" href="kanapy.html#module-src.kanapy.voxelization"><span class="std std-ref">Module voxelization</span></a> will generate hexahedral element (C3D8) mesh that can be read by commercial FEM software <a class="reference external" href="https://www.3ds.com/products-services/simulia/products/abaqus/">Abaqus</a>.</p>
<p><strong>Imports</strong>: This example requires the following methods to be imported from kanapy modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../..&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">kanapy</span>
<span class="kn">from</span> <span class="nn">src.kanapy.input_output</span> <span class="kn">import</span> <span class="n">particleStatGenerator</span>
<span class="kn">from</span> <span class="nn">src.kanapy.input_output</span> <span class="kn">import</span> <span class="n">write_abaqus_inp</span><span class="p">,</span> <span class="n">write_output_stat</span>
<span class="kn">from</span> <span class="nn">src.kanapy.packing</span> <span class="kn">import</span> <span class="n">packingRoutine</span>
<span class="kn">from</span> <span class="nn">src.kanapy.voxelization</span> <span class="kn">import</span> <span class="n">voxelizationRoutine</span>
</pre></div>
</div>
<p>The methods for generating particle distribution statistics and outputing Abaqus input file
are imported from the <code class="docutils literal notranslate"><span class="pre">input_output</span></code> module. The routine for the actual particle packing
simulation is imported from the <code class="docutils literal notranslate"><span class="pre">packing</span></code> module. And the routine for generating hexahedral mesh
is imported from <code class="docutils literal notranslate"><span class="pre">voxelization</span></code> module.</p>
<p><strong>Workflow</strong>: The complete process consists of 4 stages:</p>
<blockquote>
<div><ul class="simple">
<li><p>Particle data generation.</p></li>
<li><p>Particle packing simulation.</p></li>
<li><p>RVE voxelization.</p></li>
<li><p>Writing output files.</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">inputFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/stat_input.txt&#39;</span>
    <span class="n">particleStatGenerator</span><span class="p">(</span><span class="n">inputFile</span><span class="p">)</span>
    <span class="n">packingRoutine</span><span class="p">()</span>
    <span class="n">voxelizationRoutine</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
    <span class="n">write_abaqus_inp</span><span class="p">()</span>
    <span class="n">write_output_stat</span><span class="p">()</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>As mentioned previously, individual stages can be run by commenting out the other stages but should be done sequentially.</p></li>
<li><p>The <a class="reference internal" href="kanapy.html#src.kanapy.input_output.particleStatGenerator" title="src.kanapy.input_output.particleStatGenerator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.particleStatGenerator()</span></code></a> method requires the <code class="docutils literal notranslate"><span class="pre">stat_input.txt</span></code> as input.</p></li>
<li><p>The <a class="reference internal" href="kanapy.html#src.kanapy.voxelization.voxelizationRoutine" title="src.kanapy.voxelization.voxelizationRoutine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.voxelization.voxelizationRoutine()</span></code></a> method requires the simulation timestep as input.
The choice of the timestep is very important. It is suggested to choose the time step at which the ellipsoids
are tightly packed and there is least amount of overlap. The remaining empty spaces will get assigned to
the closest ellipsoid when it is sent to the voxelization (meshing) routine. Please refer to
<a class="reference internal" href="applications.html#microstructure-with-elongated-grains"><span class="std std-ref">Microstructure with elongated grains</span></a> for more details.</p></li>
<li><p>For comparing the input and output equivalent, major and minor diameter statistics the method
<a class="reference internal" href="kanapy.html#src.kanapy.input_output.write_output_stat" title="src.kanapy.input_output.write_output_stat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.write_output_stat()</span></code></a> can be called.</p></li>
</ol>
</div>
<p>The process of the methods <a class="reference internal" href="kanapy.html#src.kanapy.input_output.particleStatGenerator" title="src.kanapy.input_output.particleStatGenerator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.particleStatGenerator()</span></code></a> and <a class="reference internal" href="kanapy.html#src.kanapy.packing.packingRoutine" title="src.kanapy.packing.packingRoutine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.packing.packingRoutine()</span></code></a>
is similar to that described in <a class="reference internal" href="#sphere-packing"><span class="std std-ref">Sphere packing</span></a>. But for voxelization the <a class="reference internal" href="kanapy.html#src.kanapy.voxelization.voxelizationRoutine" title="src.kanapy.voxelization.voxelizationRoutine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.voxelization.voxelizationRoutine()</span></code></a>
method is called to generate the hexahedral mesh. It takes in the timestep value as an input parameter and reads the corresponding
dump file generated previously. By extracting the particle’s position and dimensions it creates the final FEM mesh. Finally,
the <a class="reference internal" href="kanapy.html#src.kanapy.input_output.write_abaqus_inp" title="src.kanapy.input_output.write_abaqus_inp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">src.kanapy.input_output.write_abaqus_inp()</span></code></a> method can be called to write out Abaqus (.inp) input file.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="method.html" class="btn btn-neutral float-right" title="Modeling approach" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="applications.html" class="btn btn-neutral float-left" title="Applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Mahesh R.G Prasad

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>