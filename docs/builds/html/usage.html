

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; kanapy 2.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modeling" href="method.html" />
    <link rel="prev" title="Applications" href="applications.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> kanapy
          

          
          </a>

          
            
            
              <div class="version">
                2.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#kanapy-s-cli">Kanapy’s CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#detailed-tutorial">Detailed tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#geometry-examples">Geometry examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-file-structure">Input file structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflows-for-sphere-packing">Workflows for sphere packing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflows-for-ellipsoid-packing">Workflows for ellipsoid packing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#texture-examples">Texture examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#workflow-for-odf-reconstruction">Workflow for ODF reconstruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflow-for-odf-reconstruction-with-orientation-assignment">Workflow for ODF reconstruction with orientation assignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#visualize-the-packing-simulation">Visualize the packing simulation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="method.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="kanapy.html">Code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">kanapy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="kanapy-s-cli">
<h2>Kanapy’s CLI<a class="headerlink" href="#kanapy-s-cli" title="Permalink to this headline">¶</a></h2>
<p>The available commands in Kanapy’s CLI and its usage is described here. The <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">kanapy</span> <span class="pre">--help</span></code> command
details this as shown:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure that you are within the virtual environment created during the kanapy installation, as
this environment contains the installed kanapy and its required dependencies.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> kanapy --help
<span class="go">          Usage: kanapy [OPTIONS] COMMAND [ARGS]...</span>
<span class="go">          Options:</span>
<span class="go">            --help  Show this message and exit.</span>

<span class="go">          Commands:</span>
<span class="go">            abaqusoutput   Writes out the Abaqus (.inp) file for the generated RVE.</span>
<span class="go">            docs           Generates a HTML-based reference documentation.</span>
<span class="go">            install        Install kanapy&#39;s geometry packing module.</span>
<span class="go">            neperoutput    Writes out particle position and weights files required</span>
<span class="go">                           for...</span>
<span class="go">            outputstats    Writes out the particle- and grain diameter attributes for...</span>
<span class="go">            pack           Packs the particles into a simulation box.</span>
<span class="go">            reducetexture  Texture reduction algorithm with optional Misorientation...</span>
<span class="go">            setuptexture   Stores the user provided MATLAB &amp; MTEX paths for texture...</span>
<span class="go">            statgenerate   Generates particle statistics based on the data provided</span>
<span class="go">                           in...</span>
<span class="go">            tests          Runs unittests built within kanapy.</span>
<span class="go">            voxelize       Generates the RVE by assigning voxels to grains.</span>
</pre></div>
</div>
<p>The functionality and the arguments of each command listed above can be requested. For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">(knpy) $</span> kanapy neperoutput --help
<span class="go">          Usage: kanapy neperoutput [OPTIONS]</span>

<span class="go">            Writes out particle position and weights files required for tessellation</span>
<span class="go">            in Neper.</span>

<span class="go">          Options:</span>
<span class="go">            --timestep TEXT  Time step for which Neper input files will be generated.</span>
<span class="go">            --help           Show this message and exit.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Bash auto-completion option is avaiable for Kanapy’s CLI commands. Run: <code class="code bash docutils literal notranslate"><span class="pre">kanapy</span> <span class="pre">autocomplete</span></code> to set it up</p>
</div>
</div>
<div class="section" id="detailed-tutorial">
<h2>Detailed tutorial<a class="headerlink" href="#detailed-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Four examples come bundled along with the kanapy package. Each example describes a particular workflow that is
either related to the geometry module or the texture module. Hence the examples are sub-categorized here under
two sub-sections: Geometry examples and Texture examples. A detailed description of these examples is presented here.
The two examples <code class="docutils literal notranslate"><span class="pre">sphere_packing</span></code> and <code class="docutils literal notranslate"><span class="pre">ellipsoid_packing</span></code> depict the different workflows
that have to be setup for generating synthetic microstructures with equiaxed and elongated
grains, respectively. And the two examples <code class="docutils literal notranslate"><span class="pre">ODF_reconstruction</span></code> and <code class="docutils literal notranslate"><span class="pre">ODF_reconstruction_with_orientation_assignment</span></code>
depict the workflows for reconstructing ODF from EBSD data and assigning orientations to RVE grains, respectively.
For a detailed understanding of the general framework of the packing simulations or the ODF reconstruction, please
refer to: <a class="reference internal" href="method.html#modeling"><span class="std std-ref">Modeling</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>New examples must be created in a separate directory. It allows the kanapy modules
an easy access to the json, dump and other files created during the simulation.</p>
</div>
<div class="section" id="geometry-examples">
<h3>Geometry examples<a class="headerlink" href="#geometry-examples" title="Permalink to this headline">¶</a></h3>
<p>Both examples <code class="docutils literal notranslate"><span class="pre">sphere_packing</span></code> and <code class="docutils literal notranslate"><span class="pre">ellipsoid_packing</span></code> contain an input file wherein the user can
specify the statistical parameters required for the simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The json and dump files help in making the various kanapy geometry modules independent
of one another during execution.</p>
</div>
<div class="section" id="input-file-structure">
<h4>Input file structure<a class="headerlink" href="#input-file-structure" title="Permalink to this headline">¶</a></h4>
<p>An exemplary structure of the input file: <code class="docutils literal notranslate"><span class="pre">stat_input.json</span></code> is shown below:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="o">{</span>
  <span class="s2">&quot;Equivalent diameter&quot;</span>:
    <span class="o">{</span>
      <span class="s2">&quot;std&quot;</span>: <span class="m">0</span>.531055,
      <span class="s2">&quot;mean&quot;</span>: <span class="m">2</span>.76736,
      <span class="s2">&quot;cutoff_min&quot;</span>: <span class="m">4</span>.0,
      <span class="s2">&quot;cutoff_max&quot;</span>: <span class="m">20</span>.0
    <span class="o">}</span>,
  <span class="s2">&quot;Aspect ratio&quot;</span>:
    <span class="o">{</span>
      <span class="s2">&quot;mean&quot;</span>: <span class="m">1</span>.0
    <span class="o">}</span>,
  <span class="s2">&quot;Tilt angle&quot;</span>:
    <span class="o">{</span>
      <span class="s2">&quot;sigma&quot;</span>: <span class="m">28</span>.8774,
      <span class="s2">&quot;mean&quot;</span>: <span class="m">87</span>.4178
    <span class="o">}</span>,
  <span class="s2">&quot;RVE&quot;</span>:
    <span class="o">{</span>
      <span class="s2">&quot;sideX&quot;</span>: <span class="m">60</span>.9,
      <span class="s2">&quot;sideY&quot;</span>: <span class="m">60</span>.9,
      <span class="s2">&quot;sideZ&quot;</span>: <span class="m">60</span>.9,
      <span class="s2">&quot;Nx&quot;</span>: <span class="m">45</span>,
      <span class="s2">&quot;Ny&quot;</span>: <span class="m">45</span>,
      <span class="s2">&quot;Nz&quot;</span>: <span class="m">45</span>
    <span class="o">}</span>,
  <span class="s2">&quot;Simulation&quot;</span>:
    <span class="o">{</span>
      <span class="s2">&quot;periodicity&quot;</span>: <span class="s2">&quot;True&quot;</span>,
      <span class="s2">&quot;output_units&quot;</span>: <span class="s2">&quot;mm&quot;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The input file is built in the JSON file format, with the following keywords: <code class="docutils literal notranslate"><span class="pre">Equivalent</span> <span class="pre">diameter,</span> <span class="pre">Aspect</span> <span class="pre">ratio,</span>
<span class="pre">Tilt</span> <span class="pre">angle,</span> <span class="pre">RVE,</span> <span class="pre">Simulation</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li><p>The keyword <code class="docutils literal notranslate"><span class="pre">Equivalent</span> <span class="pre">diameter</span></code> takes in four arguments to generate a
log-normal distribution for the particle’s equivalent diameter; they are the
<a class="reference external" href="https://en.wikipedia.org/wiki/Log-normal_distribution">Log-normal distribution’s</a> standard deviation and mean, and the minimum
and maximum cut-off values for the diameter. The values should correspond to <span class="math notranslate nohighlight">\(\mu m\)</span> scale.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Aspect</span> <span class="pre">ratio</span></code> takes only the mean value as input. If the resultant
microstructure contains equiaxed grains then this value should be set to <cite>1</cite>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Tilt</span> <span class="pre">angle</span></code> keyword represents the tilt angle of particles with
respect to the positive x-axis. Hence, to generate a distribution, it takes in
two arguments: the normal distribution’s mean and the standard deviation.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">RVE</span></code> keyword takes two types of input: the side lengths of the final RVE
required and the number of voxels per RVE side length.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> keyword takes in two inputs: A boolean value for periodicity (True/False)
and the required unit scale (<span class="math notranslate nohighlight">\(mm\)</span> or <span class="math notranslate nohighlight">\(\mu m\)</span>) for the output
ABAQUS .inp file.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The user may choose not to use the built-in voxelization (meshing) routine
for meshing the final RVE. Nevertheless, a value for <cite>voxel_per_side</cite> has to be provided.</p></li>
<li><p>A good estimation for <cite>voxel_per_side</cite> value can be made by keeping the
following point in mind: The smallest dimension of the smallest ellipsoid/sphere
should contain at least 3 voxels.</p></li>
<li><p>Particles grow during the simulation. At the start of the simulation, all particles
are initialized with null volume. At each time step, they grow in size by the
value: diameter/1000. Therefore, the last timestep would naturally contain particles
in their actual size.</p></li>
<li><p>The input unit scale should be in <span class="math notranslate nohighlight">\(\mu m\)</span> and the user can choose between
<span class="math notranslate nohighlight">\(mm\)</span> or <span class="math notranslate nohighlight">\(\mu m\)</span> as the unit scale in which output the
ABAQUS .inp file will be written.</p></li>
</ol>
</div>
</div>
<div class="section" id="workflows-for-sphere-packing">
<h4>Workflows for sphere packing<a class="headerlink" href="#workflows-for-sphere-packing" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates the workflow for generating synthetic microstructures with
equiaxed grains. The principle involved in generating such microstructures are described
in the sub-section <a class="reference internal" href="applications.html#microstructure-with-equiaxed-grains"><span class="std std-ref">Microstructure with equiaxed grains</span></a>. With respect to the final RVE mesh,
the user has the flexibility to choose between the in-built voxelization routine and external meshing softwares.</p>
<p>If external meshing is required, the positions and weights of the particles (spheres) after packing
can be written out to be post-processed. The positions and weights can be read by the Voronoi tessellation
and meshing software <a class="reference external" href="http://neper.sourceforge.net/">Neper</a> for generating tessellations and FEM mesh. For more details refer to Neper’s
<a class="reference external" href="https://ovito.org/manual/">documentation</a>.</p>
<p>If the in-built voxelization routine is prefered, then kanapy will generate
hexahedral element (C3D8) mesh that can be read by the commercial FEM software <a class="reference external" href="https://www.3ds.com/products-services/simulia/products/abaqus/">Abaqus</a>. The Abaqus .inp
file will be written out in either <span class="math notranslate nohighlight">\(mm\)</span> or <span class="math notranslate nohighlight">\(\mu m\)</span> scale.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> <span class="nb">cd</span> kanapy-master/examples/sphere_packing/
<span class="gp">(knpy) $</span> kanapy statgenerate --filename stat_input.json
<span class="gp">(knpy) $</span> kanapy pack
<span class="gp">(knpy) $</span> kanapy neperoutput --timestep <span class="m">750</span>
</pre></div>
</div>
<p>After navigating to the directory where the input file <code class="docutils literal notranslate"><span class="pre">stat_input.json</span></code> is located, kanapy’s CLI
command <code class="docutils literal notranslate"><span class="pre">statgenerate</span></code> is executed along with its argument (name of the input file). It generates the
necessary particle, RVE, and the simulation attributes, and it writes it to json files. Next the <code class="docutils literal notranslate"><span class="pre">pack</span></code> command is
called to run the particle packing simulation. This command looks for the json files generated by <code class="docutils literal notranslate"><span class="pre">statgenerate</span></code>
and reads the files for extracting the information required for the packing simulation. At each time step of the
packing simulation, kanapy will write out a dump file containing information of particle positions and other attributes.
Finally, the <code class="docutils literal notranslate"><span class="pre">neperoutput</span></code> command (Optional) can be called to write out the position and weights files
required for further post-processing. This function takes the specified timestep value as an input parameter
and reads the corresponding, previously generated dump file. By extracting the particle’s position and dimensions,
it creates the <code class="docutils literal notranslate"><span class="pre">sphere_positions.txt</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">sphere_weights.txt</span></code> files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">neperoutput</span></code> command requires the simulation timestep as input. The choice of the timestep is very important.
It is suggested to choose the time step at which the spheres are tightly packed and at which there is the least
amount of overlap. The remaining empty spaces will get assigned to the closest sphere when it is sent to the
tessellation and meshing routine. Please refer to <a class="reference internal" href="applications.html#microstructure-with-equiaxed-grains"><span class="std std-ref">Microstructure with equiaxed grains</span></a> for more details.</p></li>
<li><p>The values of position and weights for Neper will be written in <span class="math notranslate nohighlight">\(\mu m\)</span> scale only.</p></li>
</ol>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For comparing the input and output statistics:</p>
<ol class="arabic simple">
<li><p>The json file <code class="docutils literal notranslate"><span class="pre">particle_data.json</span></code> in the directory <code class="docutils literal notranslate"><span class="pre">../json_files/</span></code> can be used to read the
particle’s equivalent diameter as input statistics.</p></li>
<li><p>After tessellation, Neper can be used to generate the equivalent diameter for output statistics.</p></li>
</ol>
</div>
<p>If the built-in voxelization is prefered, then the <code class="docutils literal notranslate"><span class="pre">voxelize</span></code> command can be called to generate the hexahedral mesh.
It populates the simulation box with voxels and assigns the voxels to the respective particles (Spheres). The
<code class="docutils literal notranslate"><span class="pre">abaqusoutput</span></code> command can be called to write out the Abaqus (.inp) input file. The workflow for this looks like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> <span class="nb">cd</span> kanapy-master/examples/sphere_packing/
<span class="gp">(knpy) $</span> kanapy statgenerate --filename stat_input.json
<span class="gp">(knpy) $</span> kanapy pack
<span class="gp">(knpy) $</span> kanapy voxelize
<span class="gp">(knpy) $</span> kanapy abaqusoutput
<span class="gp">(knpy) $</span> kanapy outputstats
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The Abaqus (.inp) file will be written out in either <span class="math notranslate nohighlight">\(mm\)</span> or <span class="math notranslate nohighlight">\(\mu m\)</span> scale, depending
on the user requirement specified in the input file.</p></li>
<li><p>For comparing the input and the output equivalent diameter statistics the <code class="docutils literal notranslate"><span class="pre">outputstats</span></code> command can be
called. This command writes the diameter values in either <span class="math notranslate nohighlight">\(mm\)</span> or <span class="math notranslate nohighlight">\(\mu m\)</span> scale, depending
on the user requirement specified in the input file.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">outputstats</span></code> command also writes out the L1-error between the input and output diameter distributions</p></li>
</ol>
</div>
<p>Storing information in json &amp; dump files is effective in making the workflow stages independent of one another.
But the sequence of the workflow is important, for example: Running the packing routine before the statistics generation
is not advised as the packing routine would not have any input to work on. Both the json and the dump files are human readable,
and hence they help the user debug the code in case of simulation problems. The dump files can be read by the visualization
software <a class="reference external" href="https://ovito.org/">OVITO</a>; this provides the user a visual aid to understand the physics behind packing. For more information regarding
visualization, refer to <a class="reference internal" href="#visualize-the-packing-simulation"><span class="std std-ref">Visualize the packing simulation</span></a>.</p>
</div>
<div class="section" id="workflows-for-ellipsoid-packing">
<h4>Workflows for ellipsoid packing<a class="headerlink" href="#workflows-for-ellipsoid-packing" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates the workflow for generating synthetic microstructures with
elongated grains. The principle involved in generating such microstructures is described
in the sub-section <a class="reference internal" href="applications.html#microstructure-with-elongated-grains"><span class="std std-ref">Microstructure with elongated grains</span></a>. With respect to the final RVE mesh,
the built-in voxelization routine has to be used due to the inavailability of anisotropic tessellation techniques.
The <a class="reference internal" href="kanapy.html#module-kanapy.voxelization"><span class="std std-ref">Module voxelization</span></a> will generate a hexahedral element (C3D8) mesh that can be read by the commercial FEM software <a class="reference external" href="https://www.3ds.com/products-services/simulia/products/abaqus/">Abaqus</a>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> <span class="nb">cd</span> kanapy-master/examples/ellipsoid_packing/
<span class="gp">(knpy) $</span> kanapy statgenerate --filename stat_input.json
<span class="gp">(knpy) $</span> kanapy pack
<span class="gp">(knpy) $</span> kanapy voxelize
<span class="gp">(knpy) $</span> kanapy abaqusoutput
<span class="gp">(knpy) $</span> kanapy outputstats
</pre></div>
</div>
<p>The workflow is similar to the one described earlier for sphere packing. The only difference being, that the <code class="docutils literal notranslate"><span class="pre">neperoutput</span></code>
command is not applicable here. The <code class="docutils literal notranslate"><span class="pre">outputstats</span></code> command not only writes out the equivalent diameters, but also the
major and minor diameters of the ellipsoidal particles and grains.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>A good estimation for the RVE side length values can be made by keeping the following point in mind: The
biggest dimension of the biggest ellipsoid/sphere should be less than half of the corresponding RVE side length.</p></li>
<li><p>For comparing the input and output equivalent, major and minor diameter statistics, the command
<code class="docutils literal notranslate"><span class="pre">outputstats</span></code> can be called. Kanapy writes the diameter values in either <span class="math notranslate nohighlight">\(mm\)</span> or <span class="math notranslate nohighlight">\(\mu m\)</span> scale,
depending on the user requirement specified in the input file.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">outputstats</span></code> command also writes out the L1-error between the input and output diameter distributions</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="texture-examples">
<h3>Texture examples<a class="headerlink" href="#texture-examples" title="Permalink to this headline">¶</a></h3>
<p>Both examples <code class="docutils literal notranslate"><span class="pre">ODF_reconstruction</span></code> and <code class="docutils literal notranslate"><span class="pre">ODF_reconstruction_with_orientation_assignment</span></code> require MATLAB &amp; MTEX to be
installed in your system. If your kanapy is not configured for texture analysis, please run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> kanapy setuptexture
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Your MATLAB version must be 2015 and above.</p></li>
<li><p>The required input files must be placed in the working directory from where the kanapy commands are run.</p></li>
</ol>
</div>
<div class="section" id="workflow-for-odf-reconstruction">
<h4>Workflow for ODF reconstruction<a class="headerlink" href="#workflow-for-odf-reconstruction" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates the workflow for reconstructing ODF from experimental EBSD data. The principle involved
in generating the reduced ODF is described in the sub-section <a class="reference internal" href="applications.html#odf-reconstruction"><span class="std std-ref">ODF reconstruction</span></a>. Kanapy requires the EBSD data
estimated using MTEX as input in the (.mat) file format. In this regard, an exemplary EBSD file (<cite>titanium.mat</cite>) is
provided in the <code class="docutils literal notranslate"><span class="pre">../kanapy-master/examples/ODF_reconstruction/</span></code> folder.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> <span class="nb">cd</span> kanapy-master/examples/ODF_reconstruction/
<span class="gp">(knpy) $</span> kanapy reducetexture --ebsd titanium.mat
</pre></div>
</div>
<p>After navigating to the directory where the input file <code class="docutils literal notranslate"><span class="pre">titanium.mat</span></code> is located, kanapy’s CLI
command <code class="docutils literal notranslate"><span class="pre">reducetexture</span></code> is executed along with its argument (name of the EBSD (.mat) file). If kanapy’s
geometry module is executed already, then the number of reduced orientations are read directly. Else kanapy requests
the user to provide the number of reduced orientations required before calling the MATLAB ODF reconstruction algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The EBSD (.mat) file is a mandatory requirement for the ODF reconstruction algorithm.</p></li>
<li><p>Note here the value of the kernel shape parameter (<span class="math notranslate nohighlight">\(\kappa\)</span>) is set to a default value of 0.0873 rad.</p></li>
</ol>
</div>
<p>Alternatly, an initial kernel shape parameter (<span class="math notranslate nohighlight">\(\kappa\)</span>) can be specified as an user input (OR) the grains
estimated using MTEX can be provided as an input in the (.mat) file format. The value of <span class="math notranslate nohighlight">\(\kappa\)</span> must be in radians,
if user specified. Else if the grains (.mat) file is provided, then the optimum <span class="math notranslate nohighlight">\(\kappa\)</span> is estimated by kanapy using
the mean orientation of the grains. In this regard, an exemplary grains file (<code class="docutils literal notranslate"><span class="pre">titanium_grains.mat</span></code>) is
provided in the <code class="docutils literal notranslate"><span class="pre">../kanapy-master/examples/ODF_reconstruction/</span></code> folder. The workflow for this looks like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> <span class="nb">cd</span> kanapy-master/examples/ODF_reconstruction/
<span class="gp">(knpy) $</span> kanapy reducetexture --ebsd titanium.mat --kernel <span class="m">0</span>.096
<span class="go">                                 (OR)</span>
<span class="gp">(knpy) $</span> kanapy reducetexture --ebsd titanium.mat --grains titanium_grains.mat
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The output files are saved to the <code class="docutils literal notranslate"><span class="pre">/mat_files</span></code> folder under the current working directory.</p></li>
<li><p>The output (.txt) file contains the following information: <span class="math notranslate nohighlight">\(L_1\)</span> error of ODF reconstruction,
the initial (<span class="math notranslate nohighlight">\(\kappa\)</span>) and the optimized (<span class="math notranslate nohighlight">\(\kappa^\prime\)</span>) values, and a list of discrete orientations.</p></li>
<li><p>Additionaly kanapy saves the reduced ODF and the reduced orientations (.mat) files in this folder.</p></li>
<li><p>Kanapy writes a log file (<code class="docutils literal notranslate"><span class="pre">kanapyTexture.log</span></code>) in the current working directory for possible errors and warnings debugging.</p></li>
</ol>
</div>
</div>
<div class="section" id="workflow-for-odf-reconstruction-with-orientation-assignment">
<h4>Workflow for ODF reconstruction with orientation assignment<a class="headerlink" href="#workflow-for-odf-reconstruction-with-orientation-assignment" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates the workflow for reconstructing ODF from experimental EBSD data and then determining the optimal
assignment of orientations to RVE grains. The principle involved in optimal orientation assignment is described in the
sub-section <a class="reference internal" href="applications.html#odf-reconstruction-with-orientation-assignment"><span class="std std-ref">ODF reconstruction with orientation assignment</span></a>. In addition to the EBSD data, Kanapy requires
grain (.mat) file, and the grain boundary shared surface area information as input. In this regard, an exemplary
EBSD file (<code class="docutils literal notranslate"><span class="pre">titanium.mat</span></code>), and a grains file (<code class="docutils literal notranslate"><span class="pre">titanium_grains.mat</span></code>) are provided in the
<code class="docutils literal notranslate"><span class="pre">../kanapy-master/examples/ODF_reconstruction_with_orientation_assignment/</span></code> folder. It is important to note that
the grain boundary shared surface area file is created whilst generating an RVE by kanapy’s geometry module.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> conda activate knpy
<span class="gp">(knpy) $</span> <span class="nb">cd</span> kanapy-master/examples/ODF_reconstruction_orientation_assignment/
<span class="gp">(knpy) $</span> kanapy statgenerate --filename stat_input.json
<span class="gp">(knpy) $</span> kanapy pack
<span class="gp">(knpy) $</span> kanapy voxelize
<span class="gp">(knpy) $</span> kanapy outputstats
<span class="gp">(knpy) $</span> kanapy reducetexture --ebsd titanium.mat --grains titanium_grains.mat --fit_mad yes
</pre></div>
</div>
<p>After navigating to the directory where the input file <code class="docutils literal notranslate"><span class="pre">titanium.mat</span></code> is located, generate an RVE by calling kanapy’s
geometry CLI commands: <code class="docutils literal notranslate"><span class="pre">statgenerate</span></code>, <code class="docutils literal notranslate"><span class="pre">pack</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">voxelize</span></code>. To generate the shared surface area file,
run <code class="docutils literal notranslate"><span class="pre">outputstats</span></code> command. Kanapy will write a <code class="docutils literal notranslate"><span class="pre">shared_surfaceArea.csv</span></code>
file to the <code class="docutils literal notranslate"><span class="pre">/json_files/</span></code> folder. This file contains the grain boundary shared surface area
information between neighbouring grains. Now, kanapy’s texture CLI command <code class="docutils literal notranslate"><span class="pre">reducetexture</span></code> can be called along with
its arguments (name of the EBSD, grains (.mat) files). The key <code class="docutils literal notranslate"><span class="pre">--fit_mad</span></code> must be used with this command to tell
kanapy that orientation assignment to grains is required. Since kanapy’s geometry module is executed already, kanapy recognizes
the number of reduced orientations required (=number of grains in the RVE). Else kanapy requests the user to provide
the number of reduced orientations required before calling the MATLAB functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The EBSD, grains (.mat) files and the grain boundary shared surface file are mandatory requirements for the
orientation assignment algorithm.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">shared_surfaceArea.csv</span></code> file is generated by running <code class="docutils literal notranslate"><span class="pre">kanapy</span> <span class="pre">outputstats</span></code>.</p></li>
</ol>
</div>
<p>Additionally an optional input that can be provided is the grain volume information, which is used for weighting the
orientations after assignment and for estimating the ODF represented by the RVE. Kanapy also writes the grains volume file
(<code class="docutils literal notranslate"><span class="pre">grainsVolumes.csv</span></code>) to the <code class="docutils literal notranslate"><span class="pre">/json_files/</span></code> folder, when the <code class="docutils literal notranslate"><span class="pre">outputstats</span></code> command is executed after RVE generation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">grainsVolumes.csv</span></code> file lists the volume of each grain in the ascending order of the grain ID.</p></li>
<li><p>Kanapy automatically detects the presence of the <code class="docutils literal notranslate"><span class="pre">shared_surfaceArea.csv</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">grainsVolumes.csv</span></code> files,
if they are present in the <code class="docutils literal notranslate"><span class="pre">/json_files/</span></code> folder.</p></li>
<li><p>The output files are saved to the <code class="docutils literal notranslate"><span class="pre">/mat_files</span></code> folder under the current working directory.</p></li>
<li><p>The output (.txt) file contains the following information: <span class="math notranslate nohighlight">\(L_1\)</span> error of ODF reconstruction,
<span class="math notranslate nohighlight">\(L_1\)</span> error between disorientation angle distributions from the EBSD data and the RVE, the initial
(<span class="math notranslate nohighlight">\(\kappa\)</span>) and the optimized (<span class="math notranslate nohighlight">\(\kappa^\prime\)</span>) values, and a list of discrete orientations each
with a specific grain number that it should be assigned to.</p></li>
<li><p>Additionaly kanapy saves the reduced ODF and the reduced orientations (.mat) files in this folder.</p></li>
<li><p>Kanapy writes a log file (<code class="docutils literal notranslate"><span class="pre">kanapyTexture.log</span></code>) in the current working directory for possible errors and warnings debugging.</p></li>
</ol>
</div>
</div>
<div class="section" id="visualize-the-packing-simulation">
<h4>Visualize the packing simulation<a class="headerlink" href="#visualize-the-packing-simulation" title="Permalink to this headline">¶</a></h4>
<p>You can view the data generated by the simulation (after the simulation
is complete or during the simulation) by launching OVITO and reading in
the dump files generated by kanapy from the <code class="docutils literal notranslate"><span class="pre">../sphere_packing/dump_files/</span></code> directory.
The dump file is generated at each timestep of the particle packing simulation. It contains
the timestep, the number of particles, the simulation box dimensions and the particle’s attributes
such as its ID, position (x, y, z), axes lengths (a, b, c) and tilt angle (Quaternion format - X, Y, Z, W).
The OVITO user interface when loaded, should look similar to this:</p>
<a class="reference internal image-reference" href="_images/UI.png"><img alt="_images/UI.png" src="_images/UI.png" style="width: 750px;" /></a>
<p>By default, OVITO loads the particles as spheres, this option can be changed to visualize ellipsoids.
The asphericalshapex, asphericalshapey, and asphericalshapez columns need to be mapped to
Aspherical Shape.X, Aspherical Shape.Y, and Aspherical Shape.Z properties of OVITO when
importing the dump file. Similarily, the orientationx, orientationy, orientationz, and
orientationw particle properties need to be mapped to the Orientation.X, Orientation.Y,
Orientation.Z, and Orientation.W. OVITO cannot set up this mapping automatically, you have
to do it manually by using the <code class="docutils literal notranslate"><span class="pre">Edit</span> <span class="pre">column</span> <span class="pre">mapping</span></code> button (at the bottom-right corner
of the GUI) in the file import panel after loading the dump files. The required assignment
and components are shown here:</p>
<a class="reference internal image-reference" href="_images/UI_options.png"><img alt="_images/UI_options.png" src="_images/UI_options.png" style="width: 750px;" /></a>
<p>For further viewing customizations refer to OVITO’s <a class="reference external" href="https://ovito.org/manual/">documentation</a>.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="method.html" class="btn btn-neutral float-right" title="Modeling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="applications.html" class="btn btn-neutral float-left" title="Applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Mahesh R.G Prasad

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>